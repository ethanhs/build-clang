on: push

jobs:
  test:
    runs-on: windows-latest
    steps:
      -
        name: Checkout
        uses: actions/checkout@master
      - name: Install chocolatey
        run: Set-ExecutionPolicy Bypass -Scope Process -Force; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
        shell: powershell
      - run: choco install gnuwin32-coreutils.install ninja nsis-unicode
      - run: choco install swig --version 3.0.8
      - run: svn info https://llvm.org/svn/llvm-project/ | grep Revision | cut -d' ' -f2 > revision.txt
      - run: set /p REVISION=<revision.txt
      - run: wget https://raw.githubusercontent.com/llvm/llvm-project/master/llvm/utils/release/build_llvm_package.bat
      - run: build_llvm_package.bat %REVISION%

